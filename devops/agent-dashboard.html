<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude Code Agent Monitor - Pachacuti DevOps</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .header .last-update {
            margin-top: 10px;
            font-size: 0.9em;
            opacity: 0.8;
        }

        .dashboard {
            max-width: 1400px;
            margin: 0 auto;
        }

        .stats-bar {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
            padding: 10px 20px;
        }

        .stat-item .value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .stat-item .label {
            color: #666;
            margin-top: 5px;
        }

        .agents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .agent-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .agent-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .agent-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .agent-card.active::before {
            background: linear-gradient(90deg, #00d4ff, #00ff88);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .agent-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .agent-icon {
            font-size: 2em;
            margin-right: 15px;
        }

        .agent-info h3 {
            font-size: 1.2em;
            color: #333;
            margin-bottom: 5px;
        }

        .agent-status {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .status-active {
            background: #d4f4dd;
            color: #00a854;
        }

        .status-idle {
            background: #fff3cd;
            color: #856404;
        }

        .status-offline {
            background: #f8d7da;
            color: #721c24;
        }

        .agent-details {
            margin-top: 15px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            color: #666;
            font-size: 0.9em;
        }

        .detail-value {
            font-weight: 600;
            color: #333;
        }

        .projects-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .projects-section h2 {
            margin-bottom: 20px;
            color: #333;
        }

        .project-list {
            display: grid;
            gap: 15px;
        }

        .project-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            transition: background 0.3s ease;
        }

        .project-item:hover {
            background: #e9ecef;
        }

        .project-icon {
            font-size: 1.5em;
            margin-right: 15px;
        }

        .project-info {
            flex-grow: 1;
        }

        .project-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .project-status {
            color: #666;
            font-size: 0.9em;
        }

        .project-activity {
            text-align: right;
        }

        .activity-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-left: 5px;
        }

        .activity-high {
            background: #00ff88;
            animation: blink 1s infinite;
        }

        .activity-medium {
            background: #ffd700;
        }

        .activity-low {
            background: #ccc;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .refresh-timer {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 10px 20px;
            border-radius: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            font-size: 0.9em;
        }

        .refresh-timer .countdown {
            color: #667eea;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üéØ Claude Code Agent Monitor</h1>
        <div class="subtitle">Pachacuti DevOps Dashboard</div>
        <div class="last-update">Last Update: <span id="lastUpdate">Loading...</span></div>
    </div>

    <div class="dashboard">
        <div class="stats-bar">
            <div class="stat-item">
                <div class="value" id="activeAgents">0</div>
                <div class="label">Active Agents</div>
            </div>
            <div class="stat-item">
                <div class="value" id="totalProjects">0</div>
                <div class="label">Projects</div>
            </div>
            <div class="stat-item">
                <div class="value" id="filesModified">0</div>
                <div class="label">Files Modified</div>
            </div>
            <div class="stat-item">
                <div class="value" id="tasksCompleted">0</div>
                <div class="label">Tasks Completed</div>
            </div>
            <div class="stat-item">
                <div class="value" id="uptime">0h</div>
                <div class="label">Session Time</div>
            </div>
        </div>

        <div class="agents-grid" id="agentsGrid">
            <!-- Agent cards will be dynamically inserted here -->
        </div>

        <div class="projects-section">
            <h2>üìÅ Active Projects</h2>
            <div class="project-list" id="projectList">
                <!-- Project items will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <div class="refresh-timer">
        Auto-refresh in <span class="countdown" id="countdown">30</span>s
    </div>

    <script>
        // Mock data for demonstration - replace with actual log reading
        const mockAgents = [
            {
                id: 'pachacuti',
                name: 'Pachacuti',
                role: 'DevOps CTO',
                status: 'active',
                icon: 'ü§ñ',
                currentTask: 'Optimizing approval system',
                filesModified: 15,
                timeActive: '2h 45m',
                lastAction: 'Created auto-commit system',
                metrics: {
                    commits: 3,
                    reviews: 1,
                    deploys: 0
                }
            },
            {
                id: 'coder',
                name: 'Code Agent',
                role: 'Implementation',
                status: 'active',
                icon: 'üíª',
                currentTask: 'Writing dashboard components',
                filesModified: 3,
                timeActive: '45m',
                lastAction: 'Updated HTML structure',
                metrics: {
                    commits: 1,
                    reviews: 0,
                    deploys: 0
                }
            },
            {
                id: 'tester',
                name: 'Test Agent',
                role: 'Quality Assurance',
                status: 'idle',
                icon: 'üß™',
                currentTask: 'Waiting for tests',
                filesModified: 0,
                timeActive: '10m',
                lastAction: 'Completed test suite',
                metrics: {
                    commits: 0,
                    reviews: 2,
                    deploys: 0
                }
            },
            {
                id: 'reviewer',
                name: 'Review Agent',
                role: 'Code Review',
                status: 'active',
                icon: 'üîç',
                currentTask: 'Reviewing PR #42',
                filesModified: 0,
                timeActive: '30m',
                lastAction: 'Approved changes',
                metrics: {
                    commits: 0,
                    reviews: 5,
                    deploys: 0
                }
            }
        ];

        const mockProjects = [
            {
                name: 'crypto-campaign-unified',
                icon: 'üí∞',
                status: 'Development server active',
                activity: 'high',
                changes: 2
            },
            {
                name: 'pachacuti',
                icon: 'üéØ',
                status: 'Auto-commit enabled',
                activity: 'high',
                changes: 15
            },
            {
                name: 'claude-productivity-tools',
                icon: 'üõ†Ô∏è',
                status: '4 uncommitted changes',
                activity: 'medium',
                changes: 4
            },
            {
                name: 'visual-verification',
                icon: 'üëÅÔ∏è',
                status: 'Repository idle',
                activity: 'low',
                changes: 0
            },
            {
                name: 'note-clarify-organizer',
                icon: 'üìù',
                status: 'Vite server running',
                activity: 'medium',
                changes: 1
            }
        ];

        // Dashboard functionality
        class AgentDashboard {
            constructor() {
                this.agents = [];
                this.projects = [];
                this.refreshInterval = 30; // seconds
                this.countdown = this.refreshInterval;
                this.sessionStart = new Date();
                this.init();
            }

            init() {
                this.loadData();
                this.render();
                this.startAutoRefresh();
                this.updateStats();
            }

            loadData() {
                // In production, this would read from actual log files
                // For now, using mock data
                this.agents = mockAgents;
                this.projects = mockProjects;
                
                // Try to read from localStorage for persistence
                const savedData = localStorage.getItem('agentDashboardData');
                if (savedData) {
                    const parsed = JSON.parse(savedData);
                    // Merge with mock data
                    this.agents = [...this.agents, ...parsed.agents || []];
                    this.projects = [...this.projects, ...parsed.projects || []];
                }
            }

            render() {
                this.renderAgents();
                this.renderProjects();
                this.updateLastUpdate();
            }

            renderAgents() {
                const grid = document.getElementById('agentsGrid');
                grid.innerHTML = '';

                this.agents.forEach(agent => {
                    const card = document.createElement('div');
                    card.className = `agent-card ${agent.status === 'active' ? 'active' : ''}`;
                    
                    card.innerHTML = `
                        <div class="agent-header">
                            <div class="agent-icon">${agent.icon}</div>
                            <div class="agent-info">
                                <h3>${agent.name}</h3>
                                <span class="agent-status status-${agent.status}">${agent.status.toUpperCase()}</span>
                            </div>
                        </div>
                        <div class="agent-details">
                            <div class="detail-row">
                                <span class="detail-label">Role:</span>
                                <span class="detail-value">${agent.role}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Current Task:</span>
                                <span class="detail-value">${agent.currentTask}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Files Modified:</span>
                                <span class="detail-value">${agent.filesModified}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Time Active:</span>
                                <span class="detail-value">${agent.timeActive}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Last Action:</span>
                                <span class="detail-value">${agent.lastAction}</span>
                            </div>
                        </div>
                    `;
                    
                    grid.appendChild(card);
                });
            }

            renderProjects() {
                const list = document.getElementById('projectList');
                list.innerHTML = '';

                this.projects.forEach(project => {
                    const item = document.createElement('div');
                    item.className = 'project-item';
                    
                    item.innerHTML = `
                        <div class="project-icon">${project.icon}</div>
                        <div class="project-info">
                            <div class="project-name">${project.name}</div>
                            <div class="project-status">${project.status}</div>
                        </div>
                        <div class="project-activity">
                            ${project.changes} changes
                            <span class="activity-indicator activity-${project.activity}"></span>
                        </div>
                    `;
                    
                    list.appendChild(item);
                });
            }

            updateStats() {
                const activeAgents = this.agents.filter(a => a.status === 'active').length;
                const totalProjects = this.projects.length;
                const filesModified = this.agents.reduce((sum, a) => sum + a.filesModified, 0);
                const tasksCompleted = this.agents.reduce((sum, a) => sum + (a.metrics?.commits || 0), 0);
                
                // Calculate uptime
                const now = new Date();
                const diff = now - this.sessionStart;
                const hours = Math.floor(diff / 3600000);
                const minutes = Math.floor((diff % 3600000) / 60000);
                const uptime = hours > 0 ? `${hours}h ${minutes}m` : `${minutes}m`;

                document.getElementById('activeAgents').textContent = activeAgents;
                document.getElementById('totalProjects').textContent = totalProjects;
                document.getElementById('filesModified').textContent = filesModified;
                document.getElementById('tasksCompleted').textContent = tasksCompleted;
                document.getElementById('uptime').textContent = uptime;
            }

            updateLastUpdate() {
                const now = new Date();
                const timeString = now.toLocaleTimeString();
                document.getElementById('lastUpdate').textContent = timeString;
            }

            startAutoRefresh() {
                // Update countdown every second
                setInterval(() => {
                    this.countdown--;
                    document.getElementById('countdown').textContent = this.countdown;
                    
                    if (this.countdown <= 0) {
                        this.countdown = this.refreshInterval;
                        this.refresh();
                    }
                }, 1000);

                // Update stats every 5 seconds
                setInterval(() => {
                    this.updateStats();
                }, 5000);
            }

            refresh() {
                console.log('Refreshing dashboard...');
                this.loadData();
                this.render();
                this.updateStats();
                
                // Simulate dynamic updates
                this.simulateActivity();
            }

            simulateActivity() {
                // Randomly update some agent statuses
                if (this.agents.length > 0 && Math.random() > 0.7) {
                    const randomAgent = this.agents[Math.floor(Math.random() * this.agents.length)];
                    randomAgent.filesModified += Math.floor(Math.random() * 3);
                    randomAgent.lastAction = `Updated at ${new Date().toLocaleTimeString()}`;
                }

                // Save to localStorage for persistence
                localStorage.setItem('agentDashboardData', JSON.stringify({
                    agents: this.agents,
                    projects: this.projects,
                    lastUpdate: new Date().toISOString()
                }));
            }
        }

        // Initialize dashboard when page loads
        document.addEventListener('DOMContentLoaded', () => {
            const dashboard = new AgentDashboard();
            
            // Make dashboard accessible globally for debugging
            window.dashboard = dashboard;
            
            console.log('Agent Dashboard initialized');
        });
    </script>
</body>
</html>